# Engine API to Webflow CMS Field Mapping

## Webflow CMS Fields (Current Structure)

From the CSV export, your Webflow collection has these fields:

| # | Webflow Field | Type | Currently Used |
|---|---------------|------|----------------|
| 1 | Title | Plain Text | ‚úÖ Yes |
| 2 | Slug | Plain Text | ‚úÖ Yes |
| 3 | Collection ID | System | Auto (Webflow) |
| 4 | Locale ID | System | Auto (Webflow) |
| 5 | Item ID | System | Auto (Webflow) |
| 6 | Archived | System | Auto (Webflow) |
| 7 | Draft | System | Auto (Webflow) |
| 8 | Created On | System | Auto (Webflow) |
| 9 | Updated On | System | Auto (Webflow) |
| 10 | Published On | System | Auto (Webflow) |
| 11 | PostID | Number/Text | ‚úÖ Yes |
| 12 | Category | Plain Text | ‚úÖ Yes |
| 13 | Published | Date | ‚úÖ Yes |
| 14 | Last Updated | Date | ‚úÖ Yes |
| 15 | Last Synced | Date | ‚úÖ Yes |
| 16 | Sync Status | Plain Text | ‚úÖ Yes |
| 17 | Excerpt | Plain Text / Multi-line | ‚úÖ Yes |
| 18 | Content | Rich Text | ‚úÖ Yes |
| 19 | Featured | Switch/Boolean | ‚úÖ Yes |
| 20 | Featured (Big) | Image | ‚úÖ Yes |
| 21 | Featured (Small) | Image | ‚úÖ Yes |

---

## Engine API Fields (GetRecentPostsV2)

From your API response, Engine provides these fields:

| # | Engine Field | Type | Value |
|---|--------------|------|-------|
| 1 | postId | number | `12345` |
| 2 | title | string | `"Article Title"` |
| 3 | slug | string | `"article-title"` |
| 4 | content | string (HTML) | `"<p>Content</p>"` |
| 5 | desc | string | `"Description"` |
| 6 | timestamp | ISO Date | `"2025-10-22T13:53:57.511Z"` |
| 7 | updatedDate | ISO Date | `"2025-10-22T13:53:57.511Z"` |
| 8 | cat | string | `"Technology"` |
| 9 | color | string | `"#FF5733"` |
| 10 | tags | array | `["news", "tech"]` |
| 11 | isFeatured | boolean | `true` |
| 12 | isRecurring | boolean | `true` |
| 13 | featuredImageSmall | string (URL) | `"https://..."` |
| 14 | featuredImageBig | string (URL) | `"https://..."` |

---

## 1-to-1 Field Mapping

### ‚úÖ Perfect Matches (Already Mapped)

| Engine Field | ‚Üí | Webflow Field | Type | Notes |
|--------------|---|---------------|------|-------|
| `postId` | ‚Üí | `PostID` | Number | ‚úÖ Unique identifier |
| `title` | ‚Üí | `Title` | Text | ‚úÖ Article title |
| `slug` | ‚Üí | `Slug` | Text | ‚úÖ URL slug |
| `content` | ‚Üí | `Content` | Rich Text | ‚úÖ HTML content |
| `desc` | ‚Üí | `Excerpt` | Text | ‚úÖ Description/summary |
| `timestamp` | ‚Üí | `Published` | Date | ‚úÖ Original publish date |
| `cat` | ‚Üí | `Category` | Text | ‚úÖ Category name |
| `isFeatured` | ‚Üí | `Featured` | Switch | ‚úÖ Featured flag |
| `featuredImageBig` | ‚Üí | `Featured (Big)` | Image | ‚úÖ Hero image |
| `featuredImageSmall` | ‚Üí | `Featured (Small)` | Image | ‚úÖ Thumbnail |
| `updatedDate` | ‚Üí | `Last Updated` | Date | ‚úÖ Last modified date |
| Current sync time | ‚Üí | `Last Synced` | Date | ‚úÖ Sync timestamp |
| Sync result | ‚Üí | `Sync Status` | Text | ‚úÖ Status tracking |

**Total Mapped: 13 fields** ‚úÖ

---

## ‚ö†Ô∏è Missing Mappings (Need to Add)

### 1. Missing in Webflow: `color` (Category Color)

**Engine Field:** `color` (string, e.g., `"#FF5733"`)  
**Webflow Field:** ‚ùå **DOES NOT EXIST**

**Action Required:**
```
Add new field in Webflow CMS:
- Field Name: "Category Color" or "Color"
- Field Type: Plain Text
- Purpose: Store hex color code for category
```

### 2. Missing in Webflow: `tags` (Article Tags)

**Engine Field:** `tags` (array, e.g., `["news", "tech"]`)  
**Webflow Field:** ‚ùå **DOES NOT EXIST**

**Action Required:**
```
Add new field in Webflow CMS:
- Field Name: "Tags"
- Field Type: Plain Text (comma-separated) OR Multi-reference
- Purpose: Store article tags
```

**Note:** If you want proper tag filtering/relationships, use **Multi-reference** field type. If you just need to display tags, use **Plain Text** with comma-separated values.

### 3. Missing in Webflow: `isRecurring` (Recurring Post Flag)

**Engine Field:** `isRecurring` (boolean, e.g., `true`)  
**Webflow Field:** ‚ùå **DOES NOT EXIST**

**Action Required:**
```
Add new field in Webflow CMS:
- Field Name: "Is Recurring" or "Recurring"
- Field Type: Switch (boolean)
- Purpose: Mark recurring posts
```

**Question:** Do you actually need this field in Webflow? If not, we can skip syncing it.

---

## üìã Summary of Changes Needed

### Fields to ADD in Webflow CMS:

1. **Category Color** (Plain Text)
   - Stores: `color` from Engine
   - Format: Hex code (e.g., `#FF5733`)

2. **Tags** (Plain Text or Multi-reference)
   - Stores: `tags` from Engine
   - Format: Array of strings

3. **Is Recurring** (Switch/Boolean) - OPTIONAL
   - Stores: `isRecurring` from Engine
   - Format: Boolean

### Current Mapping Status:

| Status | Count | Fields |
|--------|-------|--------|
| ‚úÖ Already Mapped | 13 | postId, title, slug, content, desc, timestamp, updatedDate, cat, isFeatured, featuredImageBig, featuredImageSmall, lastSynced, syncStatus |
| ‚ö†Ô∏è Need to Add | 2-3 | color, tags, (isRecurring - optional) |
| ‚ùå Not Needed | 0 | None |

---

## Final Recommended Webflow Structure

After adding the missing fields, your Webflow collection should have:

### Content Fields
- ‚úÖ Title (Plain Text)
- ‚úÖ Slug (Plain Text)
- ‚úÖ Content (Rich Text)
- ‚úÖ Excerpt (Plain Text/Multi-line)

### Metadata Fields
- ‚úÖ PostID (Number/Text) - Unique identifier
- ‚úÖ Category (Plain Text)
- ‚ûï **Category Color (Plain Text)** - NEW
- ‚ûï **Tags (Plain Text or Multi-reference)** - NEW
- ‚úÖ Published (Date) - Original publish date
- ‚úÖ Last Updated (Date) - Last modified in Engine
- ‚úÖ Last Synced (Date) - Last sync timestamp
- ‚úÖ Sync Status (Plain Text) - Sync status

### Display Fields
- ‚úÖ Featured (Switch) - Is featured?
- ‚ûï **Is Recurring (Switch)** - NEW (Optional)
- ‚úÖ Featured (Big) (Image)
- ‚úÖ Featured (Small) (Image)

### System Fields (Auto-managed by Webflow)
- Collection ID
- Locale ID
- Item ID
- Archived
- Draft
- Created On
- Updated On
- Published On

---

## Smart Sync Logic with Field Mapping

```javascript
For each article from GetRecentPostsV2:
  
  1. Check if PostID exists in Webflow
  
  2. If NOT found:
     ‚Üí CREATE new article with ALL fields
  
  3. If FOUND:
     ‚Üí Compare Engine.updatedDate with Webflow.LastUpdated
     ‚Üí If Engine.updatedDate > Webflow.LastUpdated:
        ‚Üí UPDATE article with ALL fields
        ‚Üí Set Webflow.LastUpdated = Engine.updatedDate
        ‚Üí Set Webflow.LastSynced = current time
        ‚Üí Set Webflow.SyncStatus = "Synced"
     ‚Üí If same or older:
        ‚Üí SKIP (no changes needed)
```

---

## Implementation Steps

### Step 1: Add Missing Fields to Webflow
1. Open Webflow Designer
2. Go to CMS ‚Üí News Collection ‚Üí Settings
3. Add these fields:
   - **Category Color** (Plain Text)
   - **Tags** (Plain Text or Multi-reference)
   - **Is Recurring** (Switch) - Optional

### Step 2: Update Code Constants
Update `config/constants.js`:

```javascript
export const ENGINE_API = {
  STAGING: "https://uat-brochure.engine.online/api/EngineNews",
  PRODUCTION: "https://feeds.engine.online/api/EngineNews",
  ENDPOINTS: {
    RECENT_POSTS: "/GetRecentPostsV2",  // ‚Üê Changed from GetRecentPosts
    POST_BY_ID: "/GetPostById",
  },
};

export const FIELD_MAPPING = {
  postId: "PostID",
  title: "Title",
  slug: "Slug",
  content: "Content",
  desc: "Excerpt",
  timestamp: "Published",
  updatedDate: "Last Updated",  // ‚Üê NEW
  cat: "Category",
  color: "Category Color",       // ‚Üê NEW
  tags: "Tags",                   // ‚Üê NEW
  isFeatured: "Featured",
  isRecurring: "Is Recurring",    // ‚Üê NEW (optional)
  featuredImageBig: "Featured (Big)",
  featuredImageSmall: "Featured (Small)",
};
```

### Step 3: Update Transform Function
Update the data transformer to include new fields and use `updatedDate` for comparison.

---

## Questions & Answers (CONFIRMED)

### 1. ‚úÖ Tags - Create Separate Field
**Answer:** Create a NEW "Tags" field separate from Categories.

**Reason:** Tags are semantically different from Categories in the new design.

**Mapping:**
- Engine `cat` ‚Üí Webflow `Category` (existing field)
- Engine `tags` ‚Üí Webflow `Tags` (NEW field - multi-reference, comma-separated)

### 2. ‚úÖ Color Field - Create for Data Completeness
**Answer:** Create "Category Color" field for data completeness.

**Decision:** Store but don't display (deprecated in new design).

**Action:**
- Add "Category Color" field to Webflow (Plain Text - hex code)
- Sync the data from Engine
- Don't use it in frontend templates

### 3. ‚úÖ Is Recurring Field - Create for Data Completeness
**Answer:** Create "Recurring" field for data completeness.

**Decision:** Store but don't necessarily display.

**Action:**
- Add "Recurring" field to Webflow (Switch/Boolean)
- Sync the data from Engine
- Available for future use if needed

---

## Updated Field Mapping Strategy

### Fields to ADD in Webflow CMS:

1. **Tags** (Multi-reference or Plain Text) - ‚úÖ CONFIRMED
   - Maps to: Engine's `tags` array
   - Type: Multi-reference (comma-separated slugs)
   - Purpose: Store article tags (separate from Categories)
   - Display: May be used in new design

2. **Category Color** (Plain Text) - ‚úÖ CONFIRMED
   - Maps to: Engine's `color` field
   - Type: Plain Text (hex code, e.g., "#FF5733")
   - Purpose: Data completeness (deprecated in design)
   - Display: Do not display on frontend

3. **Recurring** (Switch/Boolean) - ‚úÖ CONFIRMED
   - Maps to: Engine's `isRecurring`
   - Type: Switch (boolean)
   - Purpose: Data completeness
   - Display: Available for future use

### Updated Mapping Table:

| Engine Field | ‚Üí | Webflow Field | Status | Notes |
|--------------|---|---------------|--------|-------|
| `postId` | ‚Üí | `PostID` | ‚úÖ Existing | Unique ID |
| `title` | ‚Üí | `Title` | ‚úÖ Existing | Article title |
| `slug` | ‚Üí | `Slug` | ‚úÖ Existing | URL slug |
| `content` | ‚Üí | `Content` | ‚úÖ Existing | HTML content |
| `desc` | ‚Üí | `Excerpt` | ‚úÖ Existing | Description |
| `timestamp` | ‚Üí | `Published` | ‚úÖ Existing | Publish date |
| `updatedDate` | ‚Üí | `Last Updated` | ‚úÖ Existing | Modified date |
| `cat` | ‚Üí | `Category` | ‚úÖ Existing | Category name |
| `tags` | ‚Üí | `Tags` | üÜï ADD | Separate from Category |
| `color` | ‚Üí | `Category Color` | üÜï ADD | Store only (deprecated) |
| `isFeatured` | ‚Üí | `Featured` | ‚úÖ Existing | Featured flag |
| `isRecurring` | ‚Üí | `Recurring` | üÜï ADD | For completeness |
| `featuredImageBig` | ‚Üí | `Featured (Big)` | ‚úÖ Existing | Hero image |
| `featuredImageSmall` | ‚Üí | `Featured (Small)` | ‚úÖ Existing | Thumbnail |

---

## Final Action Plan ‚úÖ CONFIRMED

### Step 1: Add 3 New Fields to Webflow CMS

1. **Tags** 
   - Field Type: Multi-reference or Plain Text (comma-separated)
   - Maps to: Engine's `tags` array
   - Separate from Category field
   - Purpose: Store article tags

2. **Category Color**
   - Field Type: Plain Text
   - Maps to: Engine's `color` field (hex code)
   - Purpose: Data completeness (deprecated, don't display)

3. **Recurring**
   - Field Type: Switch (Boolean)
   - Maps to: Engine's `isRecurring` field
   - Purpose: Data completeness (available for future use)

### Step 2: Update Code
- Update endpoint: `/GetRecentPosts` ‚Üí `/GetRecentPostsV2`
- Map `cat` ‚Üí `Category` (existing field)
- Map `tags` ‚Üí `Tags` (NEW separate field)
- Map `color` ‚Üí `Category Color` (NEW field)
- Map `isRecurring` ‚Üí `Recurring` (NEW field)
- Implement smart sync with `updatedDate` comparison
- Remove unnecessary endpoints (webhooks, manual operations)

### Step 3: Test Complete Sync
- All 14 Engine fields will map to Webflow
- No data loss
- Full data completeness

---

**Status:** ‚úÖ All decisions confirmed. Ready to implement!

---

## Verification: Webflow Fields Added ‚úÖ

**Updated Webflow CMS Structure (from CSV export):**

| # | Field Name | Status | Type |
|---|------------|--------|------|
| 1 | Title | ‚úÖ Existing | Plain Text |
| 2 | Slug | ‚úÖ Existing | Plain Text |
| 3-10 | Collection ID, Locale ID, Item ID, Archived, Draft, Created On, Updated On, Published On | ‚úÖ System | Auto (Webflow) |
| 11 | PostID | ‚úÖ Existing | Number/Text |
| 12 | Category | ‚úÖ Existing | Plain Text |
| 13 | **Tags** | üÜï ADDED | Multi-reference/Plain Text |
| 14 | Published | ‚úÖ Existing | Date |
| 15 | Last Updated | ‚úÖ Existing | Date |
| 16 | Last Synced | ‚úÖ Existing | Date |
| 17 | Sync Status | ‚úÖ Existing | Plain Text |
| 18 | Excerpt | ‚úÖ Existing | Plain Text |
| 19 | Content | ‚úÖ Existing | Rich Text |
| 20 | Featured | ‚úÖ Existing | Switch |
| 21 | **Recurring** | üÜï ADDED | Switch |
| 22 | Featured (Big) | ‚úÖ Existing | Image |
| 23 | Featured (Small) | ‚úÖ Existing | Image |
| 24 | **Category Color** | üÜï ADDED | Plain Text |

**Total Fields:** 24 (21 existing + 3 new)

**New Fields Confirmed:**
1. ‚úÖ Tags (position 13)
2. ‚úÖ Recurring (position 21)
3. ‚úÖ Category Color (position 24)

All 3 required fields have been successfully added to Webflow CMS!
